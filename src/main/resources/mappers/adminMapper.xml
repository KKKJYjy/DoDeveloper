<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dodeveloper.mappers.adminMapper">


	<select id="getBoard" resultType="AdminVO">
		select * from studyBoard order
		by stuNo desc
	</select>

	<select id="getBadMemberBoard" resultType="BadMemberBoardVO">
		select * from
		reportBoard order by reportNo desc
	</select>


	<!-- 유저 전체 조회 -->
	<select id="selectAllUser" resultType="MemberVO">
		select userId, userName,
		email, careers, registerDate, status from member
	</select>

	<!-- 유저 아이디로 조회 -->
	<select id="selectUserId" resultType="MemberVO">
		select userId, userName,
		email, careers, registerDate, status from member where userId =
		#{userId}
	</select>

	<!-- 신고내역 조회 -->
	<select id="selectReport" resultType="ReportVO">
		select * from reportBoard
	</select>

	<!-- 신고내역 삭제 -->
	<delete id="deleteReport">
		delete * from reportBoard where writer = #{userId}
	</delete>

	<!-- 유저 상태변경 -->
	<update id="updateStatus">
		update member set status = #{newStatus} where userId
		= #{userId}
	</update>

	<!-- 접속기록 저장 -->
	<insert id="insertLog">
		insert into accessLog(sessionId, uri, accessDate)
		values(#{sessionId}, #{uri}, #{accessDate})
	</insert>

	<!-- 페이지 접속 횟수 조회 -->
	<select id="selectLog"
		resultType="com.dodeveloper.admin.vo.CountUriVO">
		select a.sessionId, u.uriName,
		a.accessDate, count(*)
		from
		accessLog a, uri u
		where a.uri = #{uri}
		and
		a.uri = u.uri
	</select>

	<!-- 날짜별 접속자 수 조회 -->
	<select id="selectDatelog" resultType="com.dodeveloper.admin.vo.ConnectLogVO">
		SELECT
		DATE_FORMAT(`accessDate`, '%m-%d') as `date`,
		COUNT(*) as `count`
		FROM `accessLog`
		GROUP BY date(`accessDate`), month(`accessDate`)
		ORDER BY `date` DESC;
	</select>


</mapper>